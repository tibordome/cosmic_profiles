<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>cosmic_shapes module &mdash; cosmic_shapes 1.0.0 documentation</title>
      <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="../_static/graphviz.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="cython_helpers module" href="cython_helpers.html" />
    <link rel="prev" title="Code Reference" href="index.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="../index.html" class="icon icon-home"> cosmic_shapes
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../support.html">Support</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">Code Reference</a><ul class="current">
<li class="toctree-l2 current"><a class="current reference internal" href="#">cosmic_shapes module</a></li>
<li class="toctree-l2"><a class="reference internal" href="cython_helpers.html">cython_helpers module</a></li>
<li class="toctree-l2"><a class="reference internal" href="gen_csh_gx_cat.html">gen_csh_gx_cat module</a></li>
<li class="toctree-l2"><a class="reference internal" href="python_helpers.html">python_helpers module</a></li>
<li class="toctree-l2"><a class="reference internal" href="get_hdf5.html">get_hdf5 module</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../example_scripts/index.html">Example Scripts</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">cosmic_shapes</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
          <li><a href="index.html">Code Reference</a> &raquo;</li>
      <li>cosmic_shapes module</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/code_reference/cosmic_shapes.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <div class="section" id="cosmic-shapes-module">
<h1>cosmic_shapes module<a class="headerlink" href="#cosmic-shapes-module" title="Permalink to this headline"></a></h1>
<p>Hosts Python’s interface to <cite>cosmic_shapes</cite></p>
<span class="target" id="module-cosmic_shapes"></span><p>Created on Wed Mar  3 13:17:51 2021</p>
<dl class="py class">
<dt class="sig sig-object py" id="cosmic_shapes.CosmicShapes">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">cosmic_shapes.</span></span><span class="sig-name descname"><span class="pre">CosmicShapes</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">unicode</span> <span class="pre">CAT_DEST</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">unicode</span> <span class="pre">VIZ_DEST</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">float</span> <span class="pre">L_BOX</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">int</span> <span class="pre">MIN_NUMBER_DM_PTCS</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">int</span> <span class="pre">D_LOGSTART</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">int</span> <span class="pre">D_LOGEND</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">int</span> <span class="pre">D_BINS</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">float</span> <span class="pre">M_TOL</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">int</span> <span class="pre">N_WALL</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">int</span> <span class="pre">N_MIN</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">float</span> <span class="pre">SAFE</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">float</span> <span class="pre">start_time</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/tibordome/cosmic_shapes/cosmic_shapes.pyx"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#cosmic_shapes.CosmicShapes" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<dl class="py method">
<dt class="sig sig-object py" id="cosmic_shapes.CosmicShapes.E1_obj">
<span class="sig-name descname"><span class="pre">E1_obj</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">self</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">float[:]</span> <span class="pre">morph_info</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">float[:</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">:]</span> <span class="pre">xyz</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">float[:</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">:]</span> <span class="pre">xyz_princ</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">float[:]</span> <span class="pre">masses</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">int[:]</span> <span class="pre">ellipsoid</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">float[:]</span> <span class="pre">com</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">double</span> <span class="pre">complex[::1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">:]</span> <span class="pre">shape_tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">double[::1]</span> <span class="pre">eigval</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">double</span> <span class="pre">complex[::1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">:]</span> <span class="pre">eigvec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">float</span> <span class="pre">d</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">float</span> <span class="pre">M_TOL</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">int</span> <span class="pre">N_WALL</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">int</span> <span class="pre">N_MIN</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/tibordome/cosmic_shapes/cosmic_shapes.pyx"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#cosmic_shapes.CosmicShapes.E1_obj" title="Permalink to this definition"></a></dt>
<dd><p>E1 algorithm for halos/galaxies at elliptical radius <cite>d</cite></p>
<p>Calculates the axis ratios at a distance <cite>d</cite> from the COM of the entire particle distro.</p>
<p>Note that before and during the iteration, <cite>d</cite> is defined with respect to the COM of 
the entire particle distro, not the COM of the initial spherical volume as in Katz 1991.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>morph_info</strong> (<em>(</em><em>12</em><em>,</em><em>) </em><em>floats</em>) – Array to be filled with morphological info. 1st entry: d,
2nd entry: q, 3rd entry: s, 4th to 6th: normalized major axis, 7th to 9th: normalized intermediate axis,
10th to 12th: normalized minor axis</p></li>
<li><p><strong>xyz</strong> (<em>(</em><em>N x 3</em><em>) </em><em>floats</em>) – position array</p></li>
<li><p><strong>xyz_princ</strong> (<em>(</em><em>N x 3</em><em>) </em><em>floats</em><em>, </em><em>zeros</em>) – position arrays transformed into principal frame (varies from iteration to iteration)</p></li>
<li><p><strong>masses</strong> (<em>(</em><em>N x 1</em><em>) </em><em>floats</em>) – mass array</p></li>
<li><p><strong>ellipsoid</strong> (<em>(</em><em>N</em><em>,</em><em>) </em><em>ints</em><em>, </em><em>zeros</em>) – indices of points that fall into ellipsoid (varies from iteration to iteration)</p></li>
<li><p><strong>com</strong> (<em>(</em><em>3</em><em>,</em><em>) </em><em>floats</em>) – COM of point cloud</p></li>
<li><p><strong>shape_tensor</strong> (<em>(</em><em>3</em><em>,</em><em>3</em><em>) </em><em>complex</em><em>, </em><em>zeros</em>) – shape tensor array to be filled</p></li>
<li><p><strong>eigval</strong> (<em>(</em><em>3</em><em>,</em><em>) </em><em>double</em><em>, </em><em>zeros</em>) – eigenvalue array to be filled</p></li>
<li><p><strong>eigvec</strong> (<em>(</em><em>3</em><em>,</em><em>3</em><em>) </em><em>double</em><em>, </em><em>zeros</em>) – eigenvector array to be filled</p></li>
<li><p><strong>d</strong> (<em>float</em>) – Distance from the COM, kept fixed during iterative procedure</p></li>
<li><p><strong>M_TOL</strong> (<em>float</em>) – convergence tolerance, eigenvalue fractions must differ by less than <cite>M_TOL</cite>
for iteration to stop</p></li>
<li><p><strong>N_WALL</strong> (<em>float</em>) – maximum permissible number of iterations</p></li>
<li><p><strong>N_MIN</strong> (<em>int</em>) – minimum number of particles (DM or star particle) in any iteration; 
if undercut, shape is unclassified</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><cite>morph_info</cite> containing d, q, s, eigframe info</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>(12,) float array</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="cosmic_shapes.CosmicShapes.E1_vdisp">
<span class="sig-name descname"><span class="pre">E1_vdisp</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">self</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">float[:]</span> <span class="pre">morph_info</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">float[:</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">:]</span> <span class="pre">xyz</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">float[:</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">:]</span> <span class="pre">vxyz</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">float[:</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">:]</span> <span class="pre">xyz_princ</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">float[:]</span> <span class="pre">masses</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">int[:]</span> <span class="pre">ellipsoid</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">float[:]</span> <span class="pre">com</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">float[:]</span> <span class="pre">vcom</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">double</span> <span class="pre">complex[::1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">:]</span> <span class="pre">shape_tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">double[::1]</span> <span class="pre">eigval</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">double</span> <span class="pre">complex[::1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">:]</span> <span class="pre">eigvec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">float</span> <span class="pre">d</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">float</span> <span class="pre">M_TOL</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">int</span> <span class="pre">N_WALL</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">int</span> <span class="pre">N_MIN</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/tibordome/cosmic_shapes/cosmic_shapes.pyx"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#cosmic_shapes.CosmicShapes.E1_vdisp" title="Permalink to this definition"></a></dt>
<dd><p>Similar to <cite>E1_obj</cite> algorithm for halos/galaxies but for velocity dispersion tensor</p>
<p>Calculates the axis ratios at a distance <cite>d</cite> from the COM of the entire particle distro.</p>
<p>Note that before and during the iteration, <cite>d</cite> is defined with respect to the COM of 
the entire particle distro, not the COM of the initial spherical volume as in Katz 1991.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>morph_info</strong> (<em>(</em><em>12</em><em>,</em><em>) </em><em>floats</em>) – Array to be filled with morphological info. 1st entry: d,
2nd entry: q, 3rd entry: s, 4th to 6th: normalized major axis, 7th to 9th: normalized intermediate axis,
10th to 12th: normalized minor axis</p></li>
<li><p><strong>xyz</strong> (<em>(</em><em>N x 3</em><em>) </em><em>floats</em>) – position array</p></li>
<li><p><strong>vxyz</strong> (<em>(</em><em>N x 3</em><em>) </em><em>floats</em>) – velocity array</p></li>
<li><p><strong>xyz_princ</strong> (<em>(</em><em>N x 3</em><em>) </em><em>floats</em><em>, </em><em>zeros</em>) – position arrays transformed into principal frame (varies from iteration to iteration)</p></li>
<li><p><strong>masses</strong> (<em>(</em><em>N x 1</em><em>) </em><em>floats</em>) – mass array</p></li>
<li><p><strong>ellipsoid</strong> (<em>(</em><em>N</em><em>,</em><em>) </em><em>ints</em><em>, </em><em>zeros</em>) – indices of points that fall into ellipsoid (varies from iteration to iteration)</p></li>
<li><p><strong>com</strong> (<em>(</em><em>3</em><em>,</em><em>) </em><em>floats</em>) – COM of point cloud</p></li>
<li><p><strong>vcom</strong> (<em>(</em><em>3</em><em>,</em><em>) </em><em>floats</em>) – velocity-COM of point cloud</p></li>
<li><p><strong>shape_tensor</strong> (<em>(</em><em>3</em><em>,</em><em>3</em><em>) </em><em>complex</em><em>, </em><em>zeros</em>) – shape tensor array to be filled</p></li>
<li><p><strong>eigval</strong> (<em>(</em><em>3</em><em>,</em><em>) </em><em>double</em><em>, </em><em>zeros</em>) – eigenvalue array to be filled</p></li>
<li><p><strong>eigvec</strong> (<em>(</em><em>3</em><em>,</em><em>3</em><em>) </em><em>double</em><em>, </em><em>zeros</em>) – eigenvector array to be filled</p></li>
<li><p><strong>d</strong> (<em>float</em>) – Distance from the COM, kept fixed during iterative procedure</p></li>
<li><p><strong>M_TOL</strong> (<em>float</em>) – convergence tolerance, eigenvalue fractions must differ by less than <cite>M_TOL</cite>
for iteration to stop</p></li>
<li><p><strong>N_WALL</strong> (<em>float</em>) – maximum permissible number of iterations</p></li>
<li><p><strong>N_MIN</strong> (<em>int</em>) – minimum number of particles (DM or star particle) in any iteration; 
if undercut, shape is unclassified</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><cite>morph_info</cite> containing d, q, s, eigframe info</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>(12,) float array</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="cosmic_shapes.CosmicShapes.S1_obj">
<span class="sig-name descname"><span class="pre">S1_obj</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">self</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">float[:]</span> <span class="pre">morph_info</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">float[:</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">:]</span> <span class="pre">xyz</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">float[:</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">:]</span> <span class="pre">xyz_princ</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">float[:]</span> <span class="pre">masses</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">int[:]</span> <span class="pre">shell</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">float[:]</span> <span class="pre">com</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">double</span> <span class="pre">complex[::1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">:]</span> <span class="pre">shape_tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">double[::1]</span> <span class="pre">eigval</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">double</span> <span class="pre">complex[::1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">:]</span> <span class="pre">eigvec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">float</span> <span class="pre">d</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">float</span> <span class="pre">delta_d</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">float</span> <span class="pre">M_TOL</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">int</span> <span class="pre">N_WALL</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">int</span> <span class="pre">N_MIN</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/tibordome/cosmic_shapes/cosmic_shapes.pyx"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#cosmic_shapes.CosmicShapes.S1_obj" title="Permalink to this definition"></a></dt>
<dd><p>S1 algorithm for halos/galaxies at elliptical radius <cite>d</cite> with shell width <cite>delta_d</cite></p>
<p>Calculates the axis ratios at a distance <cite>d</cite> from the COM of the entire particle distro.</p>
<p>Note that before and during the iteration, <cite>d</cite> is defined with respect to the COM of 
the entire particle distro, not the COM of the initial spherical volume as in Katz 1991.</p>
<p>Differential version of E1.</p>
<p>Shells can cross (except 2nd shell with 1st), and a shell is assumed to be equally thick everywhere.</p>
<p>Whether we adopt the last assumption or let the thickness float (Tomassetti et al 2016) barely makes 
any difference in terms of shapes found, but the convergence properties improve for the version with fixated thickness.
For 1st shell: <cite>delta_d</cite> is <cite>d</cite></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>morph_info</strong> (<em>(</em><em>12</em><em>,</em><em>) </em><em>floats</em>) – Array to be filled with morphological info. 1st entry: d,
2nd entry: q, 3rd entry: s, 4th to 6th: normalized major axis, 7th to 9th: normalized intermediate axis,
10th to 12th: normalized minor axis</p></li>
<li><p><strong>xyz</strong> (<em>(</em><em>N x 3</em><em>) </em><em>floats</em>) – position array</p></li>
<li><p><strong>xyz_princ</strong> (<em>(</em><em>N x 3</em><em>) </em><em>floats</em><em>, </em><em>zeros</em>) – position arrays transformed into principal frame (varies from iteration to iteration)</p></li>
<li><p><strong>masses</strong> (<em>(</em><em>N x 1</em><em>) </em><em>floats</em>) – mass array</p></li>
<li><p><strong>shell</strong> (<em>(</em><em>N</em><em>,</em><em>) </em><em>ints</em><em>, </em><em>zeros</em>) – indices of points that fall into shell (varies from iteration to iteration)</p></li>
<li><p><strong>com</strong> (<em>(</em><em>3</em><em>,</em><em>) </em><em>floats</em>) – COM of point cloud</p></li>
<li><p><strong>shape_tensor</strong> (<em>(</em><em>3</em><em>,</em><em>3</em><em>) </em><em>complex</em><em>, </em><em>zeros</em>) – shape tensor array to be filled</p></li>
<li><p><strong>eigval</strong> (<em>(</em><em>3</em><em>,</em><em>) </em><em>double</em><em>, </em><em>zeros</em>) – eigenvalue array to be filled</p></li>
<li><p><strong>eigvec</strong> (<em>(</em><em>3</em><em>,</em><em>3</em><em>) </em><em>double</em><em>, </em><em>zeros</em>) – eigenvector array to be filled</p></li>
<li><p><strong>d</strong> (<em>float</em>) – Distance from the COM, kept fixed during iterative procedure</p></li>
<li><p><strong>delta_d</strong> (<em>float</em>) – thickness of the shell in real space (constant across shells in logarithmic space)</p></li>
<li><p><strong>M_TOL</strong> (<em>float</em>) – convergence tolerance, eigenvalue fractions must differ by less than <cite>M_TOL</cite>
for iteration to stop</p></li>
<li><p><strong>N_WALL</strong> (<em>float</em>) – maximum permissible number of iterations</p></li>
<li><p><strong>N_MIN</strong> (<em>int</em>) – minimum number of particles (DM or star particle) in any iteration; 
if undercut, shape is unclassified</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><cite>morph_info</cite> containing d, q, s, eigframe info</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>(12,) float array</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="cosmic_shapes.CosmicShapes.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference external" href="https://github.com/tibordome/cosmic_shapes/cosmic_shapes.pyx"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#cosmic_shapes.CosmicShapes.__init__" title="Permalink to this definition"></a></dt>
<dd><p>Constructor method. Setting instance variables</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="cosmic_shapes.CosmicShapes.getMorphLocal">
<span class="sig-name descname"><span class="pre">getMorphLocal</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">self</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">float[:</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">:]</span> <span class="pre">xyz</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cat</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">float[:]</span> <span class="pre">masses</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">float[:]</span> <span class="pre">r200</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">float</span> <span class="pre">L_BOX</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">int</span> <span class="pre">MIN_NUMBER_PTCS</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">int</span> <span class="pre">D_LOGSTART</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">int</span> <span class="pre">D_LOGEND</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">int</span> <span class="pre">D_BINS</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">int</span> <span class="pre">M_TOL</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">int</span> <span class="pre">N_WALL</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">int</span> <span class="pre">N_MIN</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/tibordome/cosmic_shapes/cosmic_shapes.pyx"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#cosmic_shapes.CosmicShapes.getMorphLocal" title="Permalink to this definition"></a></dt>
<dd><p>Calculates the local shape catalogue</p>
<p>Calls <cite>getMorphLocalObj()</cite> in an mpi4py-parallelized manner.</p>
<p>Calculates the axis ratios for the range [ <cite>r200</cite> x 10**(<cite>D_LOGSTART</cite>), <cite>r200</cite> x 10**(<cite>D_LOGEND</cite>)] from the COMs, for each object.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>xyz</strong> (<em>(</em><em>N1 x 3</em><em>) </em><em>floats</em>) – positions of all (DM or star) particles in simulation box</p></li>
<li><p><strong>cat</strong> (<em>list of length N2</em>) – each entry of the list is a list containing indices of particles belonging to an object</p></li>
<li><p><strong>masses</strong> (<em>(</em><em>N1 x 1</em><em>) </em><em>floats</em>) – masses of the particles expressed in unit mass</p></li>
<li><p><strong>r200</strong> (<em>list of length N2</em>) – each entry of the list gives the R_200 (mean not critical) radius of the parent halo</p></li>
<li><p><strong>L_BOX</strong> (<em>float</em><em>, </em><em>units: cMpc/h</em>) – simulation box side length</p></li>
<li><p><strong>MIN_NUMBER_PTCS</strong> (<em>int</em>) – minimum number of particles for object to qualify for morphology calculation</p></li>
<li><p><strong>D_LOGSTART</strong> (<em>int</em>) – logarithm of minimum ellipsoidal radius of interest, in units of R200 of parent halo</p></li>
<li><p><strong>D_LOGEND</strong> (<em>int</em>) – logarithm of maximum ellipsoidal radius of interest, in units of R200 of parent halo</p></li>
<li><p><strong>D_BINS</strong> (<em>int</em>) – number of ellipsoidal radii of interest minus 1 (i.e. number of bins)</p></li>
<li><p><strong>M_TOL</strong> (<em>float</em>) – convergence tolerance, eigenvalue fractions must differ by less than <cite>M_TOL</cite>
for iteration to stop</p></li>
<li><p><strong>N_WALL</strong> (<em>float</em>) – maximum permissible number of iterations</p></li>
<li><p><strong>N_MIN</strong> (<em>int</em>) – minimum number of particles (DM or star particle) in any iteration; 
if undercut, shape is unclassified</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>d, q, s, eigframe, COMs, masses, l_succeed: list of objects for which morphology could be determined at R200 (length: N3)</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>(N3, <cite>D_BINS</cite> + 1) floats (for d, q, s, eigframe (x3)), (N3, 3) floats (for COMs), (N3,) floats (for masses), N3-list of ints for l_succeed</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="cosmic_shapes.CosmicShapes.getMorphLocalObj">
<span class="sig-name descname"><span class="pre">getMorphLocalObj</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">self</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">float[:</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">:]</span> <span class="pre">morph_info</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">float</span> <span class="pre">r200</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">float[:]</span> <span class="pre">log_d</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">float[:</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">:]</span> <span class="pre">xyz</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">float[:</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">:]</span> <span class="pre">xyz_princ</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">float[:]</span> <span class="pre">masses</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">int[:]</span> <span class="pre">shell</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">float[:]</span> <span class="pre">com</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">double</span> <span class="pre">complex[::1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">:]</span> <span class="pre">shape_tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">double[::1]</span> <span class="pre">eigval</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">double</span> <span class="pre">complex[::1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">:]</span> <span class="pre">eigvec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">float</span> <span class="pre">M_TOL</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">int</span> <span class="pre">N_WALL</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">int</span> <span class="pre">N_MIN</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/tibordome/cosmic_shapes/cosmic_shapes.pyx"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#cosmic_shapes.CosmicShapes.getMorphLocalObj" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>Calculates the local axis ratios for the ellipsoidal radius range</dt><dd><p>[ <cite>r200</cite> x <cite>log_d</cite> [0], <cite>r200</cite> x <cite>log_d</cite> [-1]] from the COM of the point cloud</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>morph_info</strong> (<em>(</em><em>12</em><em>,</em><em>N</em><em>) </em><em>floats</em>) – Array to be filled with morphological info. For each column, 1st entry: d,
2nd entry: q, 3rd entry: s, 4th to 6th: normalized major axis, 7th to 9th: normalized intermediate axis,
10th to 12th: normalized minor axis</p></li>
<li><p><strong>r200</strong> (<em>(</em><em>N2</em><em>,</em><em>) </em><em>float array</em>) – R_200 (mean not critical) radius of the parent halo</p></li>
<li><p><strong>log_d</strong> (<em>(</em><em>N3</em><em>,</em><em>) </em><em>floats</em>) – logarithmically equally spaced ellipsoidal radius array of interest, in units of R_200 
radius of the parent halo, e.g. np.logspace(-2,1,100)</p></li>
<li><p><strong>xyz</strong> (<em>(</em><em>N1 x 3</em><em>) </em><em>floats</em>) – positions of particles in point cloud</p></li>
<li><p><strong>xyz_princ</strong> (<em>(</em><em>N1 x 3</em><em>) </em><em>floats</em><em>, </em><em>zeros</em>) – position arrays transformed into principal frame (varies from iteration to iteration)</p></li>
<li><p><strong>masses</strong> (<em>(</em><em>N1 x 1</em><em>) </em><em>floats</em>) – masses of the particles expressed in unit mass</p></li>
<li><p><strong>shell</strong> (<em>(</em><em>N</em><em>,</em><em>) </em><em>ints</em><em>, </em><em>zeros</em>) – indices of points that fall into shell (varies from iteration to iteration)</p></li>
<li><p><strong>com</strong> (<em>(</em><em>3</em><em>,</em><em>) </em><em>floats</em>) – COM of point cloud</p></li>
<li><p><strong>shape_tensor</strong> (<em>(</em><em>3</em><em>,</em><em>3</em><em>) </em><em>complex</em><em>, </em><em>zeros</em>) – shape tensor array to be filled</p></li>
<li><p><strong>eigval</strong> (<em>(</em><em>3</em><em>,</em><em>) </em><em>double</em><em>, </em><em>zeros</em>) – eigenvalue array to be filled</p></li>
<li><p><strong>eigvec</strong> (<em>(</em><em>3</em><em>,</em><em>3</em><em>) </em><em>double</em><em>, </em><em>zeros</em>) – eigenvector array to be filled</p></li>
<li><p><strong>d</strong> (<em>float</em>) – Distance from the COM, kept fixed during iterative procedure</p></li>
<li><p><strong>delta_d</strong> (<em>float</em>) – thickness of the shell in real space (constant across shells in logarithmic space)</p></li>
<li><p><strong>M_TOL</strong> (<em>float</em>) – convergence tolerance, eigenvalue fractions must differ by less than <cite>M_TOL</cite>
for iteration to stop</p></li>
<li><p><strong>N_WALL</strong> (<em>float</em>) – maximum permissible number of iterations</p></li>
<li><p><strong>N_MIN</strong> (<em>int</em>) – minimum number of particles (DM or star particle) in any iteration; 
if undercut, shape is unclassified</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><cite>morph_info</cite> containing d, q, s, eigframe info in each column, for each ellipsoidal radius</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>(12,N) float array</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="cosmic_shapes.CosmicShapes.getMorphOvrl">
<span class="sig-name descname"><span class="pre">getMorphOvrl</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">self</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">float[:</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">:]</span> <span class="pre">xyz</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cat</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">float[:]</span> <span class="pre">masses</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">float[:]</span> <span class="pre">r200</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">float</span> <span class="pre">L_BOX</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">int</span> <span class="pre">MIN_NUMBER_PTCS</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">int</span> <span class="pre">M_TOL</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">int</span> <span class="pre">N_WALL</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">int</span> <span class="pre">N_MIN</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">float</span> <span class="pre">SAFE</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/tibordome/cosmic_shapes/cosmic_shapes.pyx"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#cosmic_shapes.CosmicShapes.getMorphOvrl" title="Permalink to this definition"></a></dt>
<dd><p>Calculates the overall shape catalogue</p>
<p>Calls <cite>getMorphOvrlObj()</cite> in an mpi4py-parallelized manner.</p>
<p>Calculates the overall axis ratios and eigenframe for each object.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>xyz</strong> (<em>(</em><em>N1 x 3</em><em>) </em><em>floats</em>) – positions of all (DM or star) particles in simulation box</p></li>
<li><p><strong>cat</strong> (<em>list of length N2</em>) – each entry of the list is a list containing indices of particles belonging to an object</p></li>
<li><p><strong>masses</strong> (<em>(</em><em>N1 x 1</em><em>) </em><em>floats</em>) – masses of the particles expressed in unit mass</p></li>
<li><p><strong>r200</strong> (<em>list of length N2</em>) – each entry of the list gives the R_200 (mean not critical) radius of the parent halo</p></li>
<li><p><strong>L_BOX</strong> (<em>float</em><em>, </em><em>units: cMpc/h</em>) – simulation box side length</p></li>
<li><p><strong>MIN_NUMBER_PTCS</strong> (<em>int</em>) – minimum number of particles for object to qualify for morphology calculation</p></li>
<li><p><strong>M_TOL</strong> (<em>float</em>) – convergence tolerance, eigenvalue fractions must differ by less than <cite>M_TOL</cite>
for iteration to stop</p></li>
<li><p><strong>N_WALL</strong> (<em>float</em>) – maximum permissible number of iterations</p></li>
<li><p><strong>N_MIN</strong> (<em>int</em>) – minimum number of particles (DM or star particle) in any iteration; 
if undercut, shape is unclassified</p></li>
<li><p><strong>SAFE</strong> (<em>float</em><em>, </em><em>units: cMpc/h</em>) – ellipsoidal radius will be maxdist(COM,point)+SAFE where point is any point in the point cloud</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>d, q, s, eigframe, COMs, masses</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>(N3,) floats (for d, q, s, eigframe (x3)), (N3, 3) floats (for COMs), (N3,) floats (for masses)</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="cosmic_shapes.CosmicShapes.getMorphOvrlObj">
<span class="sig-name descname"><span class="pre">getMorphOvrlObj</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">self</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">float[:]</span> <span class="pre">morph_info</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">float</span> <span class="pre">r200</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">float[:</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">:]</span> <span class="pre">xyz</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">float[:</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">:]</span> <span class="pre">xyz_princ</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">float[:]</span> <span class="pre">masses</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">int[:]</span> <span class="pre">ellipsoid</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">float[:]</span> <span class="pre">com</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">double</span> <span class="pre">complex[::1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">:]</span> <span class="pre">shape_tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">double[::1]</span> <span class="pre">eigval</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">double</span> <span class="pre">complex[::1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">:]</span> <span class="pre">eigvec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">float</span> <span class="pre">M_TOL</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">int</span> <span class="pre">N_WALL</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">int</span> <span class="pre">N_MIN</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">float</span> <span class="pre">SAFE</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/tibordome/cosmic_shapes/cosmic_shapes.pyx"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#cosmic_shapes.CosmicShapes.getMorphOvrlObj" title="Permalink to this definition"></a></dt>
<dd><p>Calculates the overall axis ratios and eigenframe of the point cloud</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>morph_info</strong> (<em>(</em><em>12</em><em>,</em><em>) </em><em>floats</em>) – Array to be filled with morphological info. 1st entry: d,
2nd entry: q, 3rd entry: s, 4th to 6th: normalized major axis, 7th to 9th: normalized intermediate axis,
10th to 12th: normalized minor axis</p></li>
<li><p><strong>r200</strong> (<em>(</em><em>N2</em><em>,</em><em>) </em><em>float array</em>) – R_200 (mean not critical) radius of the parent halo</p></li>
<li><p><strong>xyz</strong> (<em>(</em><em>N1 x 3</em><em>) </em><em>floats</em>) – positions of particles in point cloud</p></li>
<li><p><strong>xyz_princ</strong> (<em>(</em><em>N1 x 3</em><em>) </em><em>floats</em><em>, </em><em>zeros</em>) – position arrays transformed into principal frame (varies from iteration to iteration)</p></li>
<li><p><strong>masses</strong> (<em>(</em><em>N1 x 1</em><em>) </em><em>floats</em>) – masses of the particles expressed in unit mass</p></li>
<li><p><strong>ellipsoid</strong> (<em>(</em><em>N</em><em>,</em><em>) </em><em>ints</em><em>, </em><em>zeros</em>) – indices of points that fall into ellipsoid (varies from iteration to iteration)</p></li>
<li><p><strong>com</strong> (<em>(</em><em>3</em><em>,</em><em>) </em><em>floats</em>) – COM of point cloud</p></li>
<li><p><strong>shape_tensor</strong> (<em>(</em><em>3</em><em>,</em><em>3</em><em>) </em><em>complex</em><em>, </em><em>zeros</em>) – shape tensor array to be filled</p></li>
<li><p><strong>eigval</strong> (<em>(</em><em>3</em><em>,</em><em>) </em><em>double</em><em>, </em><em>zeros</em>) – eigenvalue array to be filled</p></li>
<li><p><strong>eigvec</strong> (<em>(</em><em>3</em><em>,</em><em>3</em><em>) </em><em>double</em><em>, </em><em>zeros</em>) – eigenvector array to be filled</p></li>
<li><p><strong>d</strong> (<em>float</em>) – Distance from the COM, kept fixed during iterative procedure</p></li>
<li><p><strong>delta_d</strong> (<em>float</em>) – thickness of the shell in real space (constant across shells in logarithmic space)</p></li>
<li><p><strong>M_TOL</strong> (<em>float</em>) – convergence tolerance, eigenvalue fractions must differ by less than <cite>M_TOL</cite>
for iteration to stop</p></li>
<li><p><strong>N_WALL</strong> (<em>float</em>) – maximum permissible number of iterations</p></li>
<li><p><strong>N_MIN</strong> (<em>int</em>) – minimum number of particles (DM or star particle) in any iteration; 
if undercut, shape is unclassified</p></li>
<li><p><strong>SAFE</strong> (<em>float</em><em>, </em><em>units: cMpc/h</em>) – ellipsoidal radius will be maxdist(COM,point)+SAFE where point is any point in the point cloud</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><cite>morph_info</cite> containing d, q, s, eigframe info</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>(12,) float array</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="cosmic_shapes.CosmicShapes.getMorphOvrlVDisp">
<span class="sig-name descname"><span class="pre">getMorphOvrlVDisp</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">self</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">float[:</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">:]</span> <span class="pre">xyz</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">float[:</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">:]</span> <span class="pre">vxyz</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cat</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">float[:]</span> <span class="pre">masses</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">float[:]</span> <span class="pre">r200</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">float</span> <span class="pre">L_BOX</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">int</span> <span class="pre">MIN_NUMBER_PTCS</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">int</span> <span class="pre">M_TOL</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">int</span> <span class="pre">N_WALL</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">int</span> <span class="pre">N_MIN</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/tibordome/cosmic_shapes/cosmic_shapes.pyx"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#cosmic_shapes.CosmicShapes.getMorphOvrlVDisp" title="Permalink to this definition"></a></dt>
<dd><p>Calculates the overall velocity dipsersion shape catalogue</p>
<p>Calls <cite>getMorphOvrlVDispObj()</cite> in an mpi4py-parallelized manner.</p>
<p>Calculates the overall axis ratios and eigenframe for each object.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>xyz</strong> (<em>(</em><em>N1 x 3</em><em>) </em><em>floats</em>) – positions of all (DM or star) particles in simulation box</p></li>
<li><p><strong>vxyz</strong> (<em>(</em><em>N1 x 3</em><em>) </em><em>floats</em>) – velocities of all (DM or star) particles in simulation box</p></li>
<li><p><strong>cat</strong> (<em>list of length N2</em>) – each entry of the list is a list containing indices of particles belonging to an object</p></li>
<li><p><strong>masses</strong> (<em>(</em><em>N1 x 1</em><em>) </em><em>floats</em>) – masses of the particles expressed in unit mass</p></li>
<li><p><strong>r200</strong> (<em>list of length N2</em>) – each entry of the list gives the R_200 (mean not critical) radius of the parent halo</p></li>
<li><p><strong>L_BOX</strong> (<em>float</em><em>, </em><em>units: cMpc/h</em>) – simulation box side length</p></li>
<li><p><strong>MIN_NUMBER_PTCS</strong> (<em>int</em>) – minimum number of particles for object to qualify for morphology calculation</p></li>
<li><p><strong>M_TOL</strong> (<em>float</em>) – convergence tolerance, eigenvalue fractions must differ by less than <cite>M_TOL</cite>
for iteration to stop</p></li>
<li><p><strong>N_WALL</strong> (<em>float</em>) – maximum permissible number of iterations</p></li>
<li><p><strong>N_MIN</strong> (<em>int</em>) – minimum number of particles (DM or star particle) in any iteration; 
if undercut, shape is unclassified</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>q, s, major</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>(N3,) floats (for q, s, major (x3))</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="cosmic_shapes.CosmicShapes.getMorphOvrlVDispObj">
<span class="sig-name descname"><span class="pre">getMorphOvrlVDispObj</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">self</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">float[:]</span> <span class="pre">morph_info</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">float</span> <span class="pre">r200</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">float[:</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">:]</span> <span class="pre">xyz</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">float[:</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">:]</span> <span class="pre">vxyz</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">float[:</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">:]</span> <span class="pre">xyz_princ</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">float[:]</span> <span class="pre">masses</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">int[:]</span> <span class="pre">ellipsoid</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">float[:]</span> <span class="pre">com</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">float[:]</span> <span class="pre">vcom</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">double</span> <span class="pre">complex[::1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">:]</span> <span class="pre">shape_tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">double[::1]</span> <span class="pre">eigval</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">double</span> <span class="pre">complex[::1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">:]</span> <span class="pre">eigvec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">float</span> <span class="pre">M_TOL</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">int</span> <span class="pre">N_WALL</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">int</span> <span class="pre">N_MIN</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/tibordome/cosmic_shapes/cosmic_shapes.pyx"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#cosmic_shapes.CosmicShapes.getMorphOvrlVDispObj" title="Permalink to this definition"></a></dt>
<dd><p>Calculates the overall axis ratios and eigenframe of the point cloud</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>morph_info</strong> (<em>(</em><em>12</em><em>,</em><em>) </em><em>floats</em>) – Array to be filled with morphological info. 1st entry: d,
2nd entry: q, 3rd entry: s, 4th to 6th: normalized major axis, 7th to 9th: normalized intermediate axis,
10th to 12th: normalized minor axis</p></li>
<li><p><strong>r200</strong> (<em>(</em><em>N2</em><em>,</em><em>) </em><em>float array</em>) – R_200 (mean not critical) radius of the parent halo</p></li>
<li><p><strong>xyz</strong> (<em>(</em><em>N1 x 3</em><em>) </em><em>floats</em>) – positions of particles in point cloud</p></li>
<li><p><strong>vxyz</strong> (<em>(</em><em>N x 3</em><em>) </em><em>floats</em>) – velocity array</p></li>
<li><p><strong>xyz_princ</strong> (<em>(</em><em>N1 x 3</em><em>) </em><em>floats</em><em>, </em><em>zeros</em>) – position arrays transformed into principal frame (varies from iteration to iteration)</p></li>
<li><p><strong>masses</strong> (<em>(</em><em>N1 x 1</em><em>) </em><em>floats</em>) – masses of the particles expressed in unit mass</p></li>
<li><p><strong>ellipsoid</strong> (<em>(</em><em>N</em><em>,</em><em>) </em><em>ints</em><em>, </em><em>zeros</em>) – indices of points that fall into ellipsoid (varies from iteration to iteration)</p></li>
<li><p><strong>com</strong> (<em>(</em><em>3</em><em>,</em><em>) </em><em>floats</em>) – COM of point cloud</p></li>
<li><p><strong>vcom</strong> (<em>(</em><em>3</em><em>,</em><em>) </em><em>floats</em>) – velocity-COM of point cloud</p></li>
<li><p><strong>shape_tensor</strong> (<em>(</em><em>3</em><em>,</em><em>3</em><em>) </em><em>complex</em><em>, </em><em>zeros</em>) – shape tensor array to be filled</p></li>
<li><p><strong>eigval</strong> (<em>(</em><em>3</em><em>,</em><em>) </em><em>double</em><em>, </em><em>zeros</em>) – eigenvalue array to be filled</p></li>
<li><p><strong>eigvec</strong> (<em>(</em><em>3</em><em>,</em><em>3</em><em>) </em><em>double</em><em>, </em><em>zeros</em>) – eigenvector array to be filled</p></li>
<li><p><strong>d</strong> (<em>float</em>) – Distance from the COM, kept fixed during iterative procedure</p></li>
<li><p><strong>delta_d</strong> (<em>float</em>) – thickness of the shell in real space (constant across shells in logarithmic space)</p></li>
<li><p><strong>M_TOL</strong> (<em>float</em>) – convergence tolerance, eigenvalue fractions must differ by less than <cite>M_TOL</cite>
for iteration to stop</p></li>
<li><p><strong>N_WALL</strong> (<em>float</em>) – maximum permissible number of iterations</p></li>
<li><p><strong>N_MIN</strong> (<em>int</em>) – minimum number of particles (DM or star particle) in any iteration; 
if undercut, shape is unclassified</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><cite>morph_info</cite> containing d (= <cite>r200</cite>), q, s, eigframe info</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>(12,) float array</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="cosmic_shapes.CosmicShapesDirect">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">cosmic_shapes.</span></span><span class="sig-name descname"><span class="pre">CosmicShapesDirect</span></span><a class="reference external" href="https://github.com/tibordome/cosmic_shapes/cosmic_shapes.pyx"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#cosmic_shapes.CosmicShapesDirect" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#cosmic_shapes.CosmicShapes" title="cosmic_shapes.CosmicShapes"><code class="xref py py-class docutils literal notranslate"><span class="pre">cosmic_shapes.CosmicShapes</span></code></a></p>
<dl class="py method">
<dt class="sig sig-object py" id="cosmic_shapes.CosmicShapesDirect.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/tibordome/cosmic_shapes/cosmic_shapes.pyx"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#cosmic_shapes.CosmicShapesDirect.__init__" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="cosmic_shapes.CosmicShapesDirect.createCatMajorCOMDM">
<span class="sig-name descname"><span class="pre">createCatMajorCOMDM</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference external" href="https://github.com/tibordome/cosmic_shapes/cosmic_shapes.pyx"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#cosmic_shapes.CosmicShapesDirect.createCatMajorCOMDM" title="Permalink to this definition"></a></dt>
<dd><p>Calculates and saves halo shape catalogues</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="cosmic_shapes.CosmicShapesGadgetHDF5">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">cosmic_shapes.</span></span><span class="sig-name descname"><span class="pre">CosmicShapesGadgetHDF5</span></span><a class="reference external" href="https://github.com/tibordome/cosmic_shapes/cosmic_shapes.pyx"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#cosmic_shapes.CosmicShapesGadgetHDF5" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#cosmic_shapes.CosmicShapes" title="cosmic_shapes.CosmicShapes"><code class="xref py py-class docutils literal notranslate"><span class="pre">cosmic_shapes.CosmicShapes</span></code></a></p>
<dl class="py method">
<dt class="sig sig-object py" id="cosmic_shapes.CosmicShapesGadgetHDF5.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/tibordome/cosmic_shapes/cosmic_shapes.pyx"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#cosmic_shapes.CosmicShapesGadgetHDF5.__init__" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="cosmic_shapes.CosmicShapesGadgetHDF5.createCatDM">
<span class="sig-name descname"><span class="pre">createCatDM</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference external" href="https://github.com/tibordome/cosmic_shapes/cosmic_shapes.pyx"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#cosmic_shapes.CosmicShapesGadgetHDF5.createCatDM" title="Permalink to this definition"></a></dt>
<dd><p>Creates/Loads halo (more precisely: CSH) catalogues from FOF data</p>
<p>Stores R200, masses of halos etc..</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="cosmic_shapes.CosmicShapesGadgetHDF5.createCatMajorCOMDM">
<span class="sig-name descname"><span class="pre">createCatMajorCOMDM</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference external" href="https://github.com/tibordome/cosmic_shapes/cosmic_shapes.pyx"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#cosmic_shapes.CosmicShapesGadgetHDF5.createCatMajorCOMDM" title="Permalink to this definition"></a></dt>
<dd><p>Calculates and saves halo shape catalogues</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="cosmic_shapes.CosmicShapesGadgetHDF5.createCatMajorCOMGx">
<span class="sig-name descname"><span class="pre">createCatMajorCOMGx</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference external" href="https://github.com/tibordome/cosmic_shapes/cosmic_shapes.pyx"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#cosmic_shapes.CosmicShapesGadgetHDF5.createCatMajorCOMGx" title="Permalink to this definition"></a></dt>
<dd><p>Calculates and saves galaxy shape catalogues</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="cosmic_shapes.CosmicShapesGadgetHDF5.vizObjShapeLocal">
<span class="sig-name descname"><span class="pre">vizObjShapeLocal</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference external" href="https://github.com/tibordome/cosmic_shapes/cosmic_shapes.pyx"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#cosmic_shapes.CosmicShapesGadgetHDF5.vizObjShapeLocal" title="Permalink to this definition"></a></dt>
<dd><p>Visualize local shape of objects with numbers <cite>obj_numbers</cite></p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="cosmic_shapes.CosmicShapesGadgetHDF5.vizObjShapeOvrl">
<span class="sig-name descname"><span class="pre">vizObjShapeOvrl</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference external" href="https://github.com/tibordome/cosmic_shapes/cosmic_shapes.pyx"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#cosmic_shapes.CosmicShapesGadgetHDF5.vizObjShapeOvrl" title="Permalink to this definition"></a></dt>
<dd><p>Visualize overall shape of objects with numbers <cite>obj_numbers</cite></p>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="cosmic_shapes.createHaloFixedAxisRatioRhoAlphaBetaGamma">
<span class="sig-prename descclassname"><span class="pre">cosmic_shapes.</span></span><span class="sig-name descname"><span class="pre">createHaloFixedAxisRatioRhoAlphaBetaGamma</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">N_min</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alpha</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">beta</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gamma</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rho_0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">r_s</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">a</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">b</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">c</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/tibordome/cosmic_shapes/cosmic_shapes.pyx"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#cosmic_shapes.createHaloFixedAxisRatioRhoAlphaBetaGamma" title="Permalink to this definition"></a></dt>
<dd><p>Mock halo generator</p>
<p>Create mock halo consisting of <cite>N_min</cite> particles in 1st shell. The alpha-beta-gamma 
density profile is a generalization of the Navarro-Frank-White (NFW) profile. Its definition
can be looked up in Zemp et al 2011, <a class="reference external" href="https://arxiv.org/abs/1107.5582">https://arxiv.org/abs/1107.5582</a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>N_min</strong> (<em>int</em>) – number of particles in 1st shell. Will be scaled appropriately 
in each shell to satisfy alpha-beta-gamma profile</p></li>
<li><p><strong>alpha</strong> (<em>float</em>) – <cite>alpha</cite> parameter in alpha-beta-gamma density profile</p></li>
<li><p><strong>beta</strong> (<em>float</em>) – <cite>beta</cite> parameter in alpha-beta-gamma density profile</p></li>
<li><p><strong>gamma</strong> (<em>float</em>) – <cite>gamma</cite> parameter in alpha-beta-gamma density profile</p></li>
<li><p><strong>rho_0</strong> (<em>float</em>) – <cite>rho_0</cite> parameter in alpha-beta-gamma density profile (density at the center)</p></li>
<li><p><strong>r_s</strong> (<em>float</em>) – <cite>r_s</cite> parameter in alpha-beta-gamma density profile (scale radius)</p></li>
<li><p><strong>a</strong> (<em>float array</em>) – major axis array</p></li>
<li><p><strong>b</strong> (<em>float array</em>) – intermediate axis array</p></li>
<li><p><strong>c</strong> (<em>float array</em>) – minor axis array</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>halo_x, halo_y, halo_z: arrays containing positions of halo particles</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>3 (N,) float arrays</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="cosmic_shapes.createLogNormUni">
<span class="sig-prename descclassname"><span class="pre">cosmic_shapes.</span></span><span class="sig-name descname"><span class="pre">createLogNormUni</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">BoxSize</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nbar</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">redshift</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Nmesh</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">UNIT_MASS</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">h</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/tibordome/cosmic_shapes/cosmic_shapes.pyx"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#cosmic_shapes.createLogNormUni" title="Permalink to this definition"></a></dt>
<dd><p>Create mock simulation box by Poisson-sampling a lognormal density distribution</p>
<p>The Poisson-sampled distribution is evolved according to the Zeldovich (1LPT) prescription
up until redshift <cite>redshift</cite> under the constraint of an ‘EisensteinHu’ power spectrum</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>BoxSize</strong> (<em>float</em>) – size of to-be-obtained simulation box</p></li>
<li><p><strong>nbar</strong> (<em>float</em>) – number density of points (i.e. sampling density / resolution) in box, units: 1/(cMpc/h)**3
Note: <cite>nbar</cite> is assumed to be constant across the box</p></li>
<li><p><strong>redshift</strong> (<em>float</em>) – redshift of interest</p></li>
<li><p><strong>Nmesh</strong> (<em>int</em>) – the mesh size to use when generating the density and displacement fields, 
which are Poisson-sampled to particles</p></li>
<li><p><strong>UNIT_MASS</strong> (<em>float</em>) – in units of solar masses / h. Returned masses will have units UNIT_MASS*(solar_mass)/h</p></li>
<li><p><strong>h</strong> (<em>float</em>) – little H</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>total number of particles, xyz-coordinates of DM particles, xyz-values of DM particle velocities, 
masses of the DM particles (all identical)</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>int, (N,) floats, (N,) floats, (N,) floats, (N,) floats, (N,) floats, (N,) floats, (N,) floats</p>
</dd>
</dl>
</dd></dl>

</div>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="index.html" class="btn btn-neutral float-left" title="Code Reference" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="cython_helpers.html" class="btn btn-neutral float-right" title="cython_helpers module" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2022, Tibor Dome.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>